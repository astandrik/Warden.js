!function(a,b){"object"==typeof exports&&exports?b(exports):(null==a.Warden&&(Warden={}),b(Warden),"function"==typeof define&&define.amd?define(Warden):a.Warden=Warden)}(this,function(a){a.version="0.0.0",a.toString=function(){return a.stringify(a)},a.create=function(b,c){var d={},e={},f={};return f.max=c&&c.max||128,b.prototype.emit=function(a){var c=this;return null!=d[a.type]&&d[a.type].map(function(b){return b.evaluate(a,c)}),b.trigger&&b.trigger(a),null!=e[a.type]&&e[a.type].map(function(b){var d=b.config&&b.config.context||c,e=b.config&&b.config.adj;return b.callback.apply(d,[a].concat(e))}),this},void 0===b.on&&(b.prototype.on=function(a,b,c){if("string"!=typeof a)throw"Type Error: Wrong argument[1] in .on method. Expected string.";if("function"!=typeof b)throw"Type Error: Wrong argument[2] in .on method. Expected function.";if(null==e[a]&&(e[a]=[]),e[a].length>=f.max)throw"The maximum number ("+f.max+") of handler for event ["+a+"] exceed.";return e[a].push({callback:b,config:c}),this}),b.prototype.stream=function(b,c){var e=a.stream(b,c);return null==d[b]&&(d[b]=[]),d[b].push(e),e},b},a.stream=function(a,b){var c=function(){function a(a){this.process=null!=a?a:[],this.taken=0,this.history=[]}return a.prototype.exec=function(a,b){var c=this,d=a;d.timestamp=(new Date).getTime(),d.environment="Warden 0.0.0";for(var e=0,f=this.process.length;f>e;e++)switch(process=this.process[e],fn=process.fn,process.type){case"m":"function"==typeof fn?d=fn(d):"string"==typeof fn?void 0!==d[fn]&&(d=d[fn]):d=fn,c.mapped=!0;break;case"f":if("function"==typeof fn){if(fn(d)===!1)return!1}else if(Boolean(fn)===!1)return!1}return this.limit&&this.taken>=this.limit?!1:(this.taken++,this.final.apply(b,[d]))},a}(),d={type:a,name:b,config:[],activeBus:[]};return c.prototype.map=function(a){return new c(this.process.concat({type:"m",fn:a}))},c.prototype.filter=function(a){return new c(this.process.concat({type:"f",fn:a}))},c.prototype.take=function(a,b){if("function"==typeof a)return this.filter(a);var d=new c(this.process);return null!=b||(this.limit=a,d.limit=a),d},c.prototype.listen=function(a){return this.final=a,d.activeBus.push(this),this},c.prototype.evaluate=function(a,b){return d.activeBus.map(function(c){return c.exec(a,b)})},new c},a.stringify=function(b,c,d){var e,f,g,h,i,h="",g="";if(h="{"+(c?"\n":" "),d=d?d:0,d>2)return h="[object]";for(var e=0;e++<=d&&c;)g+="	";for(f in b)i=b[f],h+=""+g+f+":",h+="object"==typeof i?a.stringify(i,c,d+1)+(c?",\n":", "):null!=i?"string"==typeof i?"'"+i.toString()+"'"+(c?",\n":", "):i.toString()+(c?",\n":", "):"'undefined'"+(c?",\n":", ");return h=h.slice(0,-2),h+=d>0?" }":c?"\n}":" }"}});